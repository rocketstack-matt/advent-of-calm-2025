{
    "$schema": "https://calm.finos.org/release/1.0/meta/calm.json",
    "$id": "https://example.com/patterns/web-app.json",
    "title": "Standard Web Application Pattern",
    "description": "Three-tier web application with frontend, API, and database",
    "type": "object",
    "properties": {
        "nodes": {
            "type": "array",
            "minItems": 3,
            "maxItems": 3,
            "prefixItems": [
                {
                    "$ref": "https://calm.finos.org/release/1.0/meta/core.json#/defs/node",
                    "type": "object",
                    "properties": {
                        "unique-id": {
                            "const": "web-frontend"
                        },
                        "node-type": {
                            "const": "webclient"
                        },
                        "name": {
                            "const": "Web Frontend"
                        },
                        "description": {
                            "const": "User-facing web application"
                        }
                    }
                },
                {
                    "$ref": "https://calm.finos.org/release/1.0/meta/core.json#/defs/node",
                    "type": "object",
                    "properties": {
                        "unique-id": {
                            "const": "api-service"
                        },
                        "node-type": {
                            "const": "service"
                        },
                        "name": {
                            "const": "API Service"
                        },
                        "description": {
                            "const": "Backend API service"
                        }
                    }
                },
                {
                    "$ref": "https://calm.finos.org/release/1.0/meta/core.json#/defs/node",
                    "type": "object",
                    "properties": {
                        "unique-id": {
                            "const": "app-database"
                        },
                        "node-type": {
                            "const": "database"
                        },
                        "name": {
                            "const": "Application Database"
                        },
                        "description": {
                            "const": "Primary data storage"
                        }
                    }
                }
            ]
        },
        "relationships": {
            "type": "array",
            "minItems": 2,
            "maxItems": 2,
            "prefixItems": [
                {
                    "$ref": "https://calm.finos.org/release/1.0/meta/core.json#/defs/relationship",
                    "type": "object",
                    "properties": {
                        "unique-id": {
                            "const": "frontend-to-api"
                        },
                        "description": {
                            "const": "Frontend calls API"
                        },
                        "protocol": {
                            "const": "HTTPS"
                        },
                        "relationship-type": {
                            "const": {
                                "connects": {
                                    "source": {
                                        "node": "web-frontend"
                                    },
                                    "destination": {
                                        "node": "api-service"
                                    }
                                }
                            }
                        }
                    },
                    "required": ["description"]
                },
                {
                    "$ref": "https://calm.finos.org/release/1.0/meta/core.json#/defs/relationship",
                    "type": "object",
                    "properties": {
                        "unique-id": {
                            "const": "api-to-database"
                        },
                        "description": {
                            "const": "API stores data"
                        },
                        "protocol": {
                            "const": "JDBC"
                        },
                        "relationship-type": {
                            "const": {
                                "connects": {
                                    "source": {
                                        "node": "api-service"
                                    },
                                    "destination": {
                                        "node": "app-database"
                                    }
                                }
                            }
                        }
                    },
                    "required": ["description"]
                }
            ]
        }
    },
    "required": ["nodes", "relationships"]
}
